<div class="player-analysis-container">
  <h2>âš½ AnÃ¡lisis de {{ player?.nombre }}</h2>

  <div class="player-info">
    <img [src]="player?.profile_picture || 'assets/default-avatar.png'" alt="Foto jugador">
    <h3>{{ player?.nombre }}</h3>
    <p><strong>Equipo:</strong> {{ player?.equipo }}</p>
    <p><strong>Nacionalidad:</strong> {{ player?.nacionalidad }}</p>
  </div>

  <h3>ğŸ“œ AnÃ¡lisis</h3>
  <div class="analysis-card" *ngFor="let analysis of analyses">
    <p><strong>CategorÃ­a:</strong> {{ analysis.categoria_texto }}</p>
    <p><strong>Comentario:</strong> {{ analysis.texto }}</p>

    <!-- ğŸ”¹ Si el anÃ¡lisis NO tiene anÃ¡lisis NLP, permitir analizar con IA -->
    <button *ngIf="analysis.id !== undefined && !nlpAnalyses.has(analysis.id)" 
            (click)="analyzeWithIA(analysis.id)" 
            [disabled]="isLoading">
      ğŸ¤– Analizar con IA
    </button>

    <!-- ğŸ”¹ Si YA existe el anÃ¡lisis NLP, mostrar el botÃ³n para ver detalles -->
    <div *ngIf="analysis.id !== undefined && nlpAnalyses.has(analysis.id)">
      <button (click)="openModal(analysis.id)">ğŸ“Š Ver AnÃ¡lisis en Modal</button>
    </div>
  </div>
</div>

<!-- Modal -->
<app-nlp-analysis-modal 
  [analysis]="selectedNlpAnalysis" 
  [isOpen]="isModalOpen" 
  (close)="closeModal()">
</app-nlp-analysis-modal>
